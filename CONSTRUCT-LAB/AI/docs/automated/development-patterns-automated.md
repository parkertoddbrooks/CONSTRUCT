# CONSTRUCT Development Patterns

**Last Updated**: Thu Jul  3 19:33:46 PDT 2025
**Generated by**: update-architecture.sh

## Script Development Patterns

### Standard Script Structure

All CONSTRUCT development scripts follow this pattern:

```bash
#!/bin/bash

# Script Description
# Brief explanation of what this script does

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Source library functions
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "/Users/parker/Documents/dev/claude-engineer/_Projects/CONSTRUCT/CONSTRUCT-LAB/CONSTRUCT/scripts/../lib/common-patterns.sh"

# Get project directories using library functions
CONSTRUCT_ROOT=/Users/parker/Documents/dev/claude-engineer/_Projects/CONSTRUCT
CONSTRUCT_DEV=/Users/parker/Documents/dev/claude-engineer/_Projects/CONSTRUCT/CONSTRUCT-LAB

# Source library functions
source "$CONSTRUCT_DEV/CONSTRUCT/lib/validation.sh"

echo -e "${BLUE}üîç Script Description...${NC}"
echo ""

# Main logic with proper error handling
main() {
    # Implementation
}

main "$@"
```

### Error Handling Patterns

#### Required Error Handling
- Always use `set -e` for fail-fast behavior
- Source library functions with proper path resolution
- Use colored output for status reporting
- Implement proper exit codes

#### Validation Pattern
```bash
validate_input() {
    local input=$1
    
    if [ -z "$input" ]; then
        echo -e "${RED}‚ùå Error: Input required${NC}"
        exit 1
    fi
    
    if [ ! -f "$input" ]; then
        echo -e "${RED}‚ùå Error: File not found: $input${NC}"
        exit 1
    fi
}
```

### Output Formatting Patterns

#### Status Indicators
- ‚úÖ Success/Pass
- ‚ùå Error/Fail  
- ‚ö†Ô∏è Warning/Attention needed
- üîç Analysis/Investigation
- üìä Statistics/Metrics
- üí° Insights/Tips

#### Color Coding
- `GREEN`: Success, pass, good status
- `RED`: Errors, failures, critical issues
- `YELLOW`: Warnings, attention needed, suggestions
- `BLUE`: Information, headers, process status

### Library Function Patterns

#### Function Documentation
```bash
# Validates directory exists and is readable
validate_directory() {
    local dir=$1
    # Implementation
}
```

#### Configuration-Driven Validation
```bash
# Load validation rules from YAML config
load_validation_rules() {
    local config_file="$CONSTRUCT_DEV/CONSTRUCT/config/quality-gates.yaml"
    # Parse and apply rules
}
```

## Development Workflow Patterns

### Context Update Pattern
1. Analyze current state
2. Generate structured data
3. Update AI context file
4. Provide next step suggestions

### Quality Check Pattern
1. Run multiple validation categories
2. Count violations by severity
3. Provide actionable feedback
4. Exit with appropriate code

### Structure Analysis Pattern
1. Scan directory structure
2. Categorize and count components
3. Generate both detailed and summary reports
4. Identify architectural patterns and gaps

## Configuration Patterns

### YAML Configuration Structure
```yaml
# Configuration file description
# Purpose and usage notes

rules:
  category1:
    forbidden_patterns:
      - "pattern1"
      - "pattern2"
    required_patterns:
      - "pattern3"
      
  category2:
    thresholds:
      warning: 5
      error: 10
```

### Configuration Loading Pattern
```bash
load_config() {
    local config_file="$1"
    
    if [ ! -f "$config_file" ]; then
        echo -e "${RED}‚ùå Config file not found: $config_file${NC}"
        exit 1
    fi
    
    # Parse YAML and extract values
}
```

## Testing Patterns

### Script Testing Structure
```bash
# Test script template
test_script_functionality() {
    local script_path="$1"
    
    # Test 1: Script exists and is executable
    if [ ! -x "$script_path" ]; then
        echo "‚ùå Script not executable: $script_path"
        return 1
    fi
    
    # Test 2: Script runs without errors
    if ! "$script_path" --help &>/dev/null; then
        echo "‚ùå Script help failed: $script_path"
        return 1
    fi
    
    echo "‚úÖ Script tests passed: $script_path"
    return 0
}
```

## Documentation Patterns

### Auto-Generated Documentation
- Use consistent headers with generation timestamp
- Include script/command that generated the documentation
- Provide context about purpose and usage
- Update documentation as part of development workflow

### Session Documentation
- Record development decisions and rationale
- Track architectural changes and their impact
- Document discovered patterns and anti-patterns
- Maintain development timeline and milestones

---

*This document is auto-generated. To update, run: ./CONSTRUCT/scripts/update-architecture.sh*
