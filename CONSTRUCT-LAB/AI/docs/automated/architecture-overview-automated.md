# CONSTRUCT Development Architecture

**Last Updated**: Thu Jul  3 12:17:05 PDT 2025
**Generated by**: update-architecture.sh

## Overview

CONSTRUCT uses a three-layer architecture:
1. **CONSTRUCT-CORE** - Universal orchestration engine (stable, production-ready)
2. **CONSTRUCT-LAB** - Development environment for improving CONSTRUCT
3. **TEMPLATES** - Production-ready project templates for users

### Architecture Layers

#### CONSTRUCT-CORE
- Universal scripts and orchestration logic
- Language-agnostic tools that work everywhere
- Stable, versioned releases
- Embedded in both LAB and TEMPLATES via symlinks

#### CONSTRUCT-LAB
- Development and experimentation environment
- Test new features and improvements
- Contains all development artifacts and history
- Uses CONSTRUCT-CORE for its own operations

#### TEMPLATES
- Clean, production-ready starting points
- Currently: swift-ios (more coming)
- Each template embeds CONSTRUCT-CORE
- No development artifacts, just what users need

## Architecture Principles

### Dual Environment Design
- **Separation of Concerns**: CONSTRUCT development vs user development
- **Identical Patterns**: Same workflow commands across different domains
- **Domain Expertise**: Each environment understands its architectural patterns
- **Cross-Pollination**: Insights from one environment improve the other

### Self-Improving System
- CONSTRUCT uses its own methodology to improve itself
- AI-assisted development workflows for both shell and Swift code
- Automated quality gates and architecture enforcement
- Continuous documentation updates

## Directory Structure

```
CONSTRUCT/
├── CONSTRUCT-CORE/              # Universal orchestration engine
│   ├── orchestrator/           # Language detection and routing
│   ├── adapters/              # Language-specific implementations
│   ├── scripts/               # Core workflow scripts
│   ├── lib/                   # Shared library functions
│   ├── config/                # Core configuration
│   └── VERSION                # Semantic versioning
├── CONSTRUCT-LAB/              # Development environment
│   ├── AI/                    # Development context and tools
│   │   ├── CLAUDE.md         # Auto-updating development context
│   │   ├── structure/        # Architecture snapshots
│   │   ├── todo/            # Development planning
│   │   └── dev-logs/        # Session documentation
│   ├── CONSTRUCT -> ../CONSTRUCT-CORE  # Symlink to core
│   └── experiments/          # New feature development
└── TEMPLATES/                  # Production-ready templates
    └── swift-ios/             # Swift/iOS template
        ├── AI/                # Template AI context
        ├── CONSTRUCT -> ../../CONSTRUCT-CORE  # Symlink
        └── swift/             # Swift project files
            ├── MyApp.xcodeproj/
            ├── iOS-App/
            └── Watch-App/
```

## Component Architecture

### AI Scripts Architecture
Each environment has parallel AI-assisted workflow scripts:

#### CONSTRUCT Development Scripts (Shell/Python Focus)
- `update-context.sh` - Updates CONSTRUCT development context
- `check-architecture.sh` - Validates shell script patterns
- `check-quality.sh` - Shell script quality gates
- `scan_construct_structure.sh` - CONSTRUCT infrastructure analysis
- `check-documentation.sh` - Documentation coverage validation
- `before_coding.sh` - Pre-coding guidance for shell development
- `session-summary.sh` - CONSTRUCT development session summaries
- `setup-aliases.sh` - Development workflow aliases
- `update-architecture.sh` - This script (architecture docs)

#### User Project Scripts (Swift MVVM Focus)
- `update-context.sh` - Updates Swift project context
- `check-architecture.sh` - Validates Swift MVVM patterns
- `check-quality.sh` - Swift code quality gates
- `scan_mvvm_structure.sh` - Swift component analysis
- `check-accessibility.sh` - iOS accessibility validation
- `before_coding.sh` - Pre-coding guidance for Swift development
- `session-summary.sh` - Swift development session summaries
- `setup-aliases.sh` - User development aliases
- `update-architecture.sh` - Swift architecture documentation

### Library Architecture

#### Shared Functions (lib/)
- `validation.sh` - Common validation patterns
- `file-analysis.sh` - Code parsing and analysis
- `template-utils.sh` - Template management utilities

### Configuration Architecture

#### Configuration-Driven Validation (config/)
- `mvvm-rules.yaml` - Swift MVVM pattern rules
- `quality-gates.yaml` - Quality thresholds and standards

## Data Flow

### Development Context Flow
1. Scripts analyze current state
2. Generate structured documentation
3. Update AI context files (CLAUDE.md)
4. AI uses context for intelligent assistance
5. Discoveries fed back into templates and patterns

### Cross-Environment Flow
1. CONSTRUCT development creates/improves tools
2. Tools tested against USER-project-files/
3. Patterns extracted from user development
4. Insights fed back into CONSTRUCT improvements
5. Templates updated based on real usage

## Quality Assurance

### Automated Quality Gates
- Shell script syntax validation
- Error handling pattern enforcement
- Hardcoded path detection
- Function documentation requirements
- Configuration file validation
- Test coverage analysis

### Architecture Enforcement
- MVVM pattern compliance (Swift)
- Shell best practices (CONSTRUCT development)
- Configuration-driven rule validation
- Automated pre-commit hooks

### Documentation Standards
- Auto-updating context files
- Comprehensive session logging
- Architecture decision records
- Development milestone tracking

## Extension Points

### Adding New Scripts
1. Follow established error handling patterns
2. Use library functions where possible
3. Add proper documentation and usage examples
4. Include quality checks and validation
5. Update architecture documentation

### Adding New Validations
1. Define rules in config/ YAML files
2. Implement validation logic in library functions
3. Add checks to quality gate scripts
4. Document new patterns and standards

### Cross-Environment Analysis
1. Create analysis scripts in CONSTRUCT-LAB/
2. Read-only analysis of USER-project-files/
3. Extract patterns and insights
4. Feed discoveries back into templates

## Security Considerations

### Path Safety
- All scripts use relative path resolution
- No hardcoded absolute paths
- Proper validation of input paths
- Safe directory traversal patterns

### Template Integrity
- Read-only analysis of user projects
- No modification of USER-project-files/ from CONSTRUCT scripts
- Separate development and user contexts
- Safe template updates and testing

---

*This document is auto-generated. To update, run: ./CONSTRUCT/scripts/update-architecture.sh*
